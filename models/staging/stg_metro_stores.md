# Staging Model: stg_metro_stores

## Overview
The `stg_metro_stores` model is designed to extract, transform, and standardize raw store data from the POS system for Metro. This model pulls data from the `raw_metro_stores` table in the `pos` schema, renames columns to improve clarity, and generates a composite unique identifier for each store. These transformations ensure the data is consistent and ready for downstream processing and analytics.

## Source Data
- **Source Table:** `pos.raw_metro_stores`
- **Raw Columns:**
  - `Store Name`
  - `Operational Site`
  - `Banner Description`
  - `Province`
  - `retail_group`

## Transformations Applied
### Column Renaming
- **Store Name → store_name:**
  The `Store Name` column is renamed to `store_name` to clearly represent the name of the store.
- **Operational Site → store_id:**
  The `Operational Site` column is renamed to `store_id` and serves as the unique identifier for each store.
- **Banner Description → banner:**
  The `Banner Description` column is renamed to `banner` to indicate the store's banner or brand.
- **Province → province:**
  The `Province` column is retained as `province` to indicate the geographical province of the store.
- **retail_group:**
  This field is carried forward without changes, representing the retail group affiliation of the store.

### Derived Field
- **unique_store_id:**
  A composite unique identifier is generated by concatenating `retail_group` and `Operational Site` (i.e., `store_id`) with a pipe (`|`) separator. This field ensures that each store record is uniquely identifiable and simplifies downstream joins and aggregations.

## Business Logic & Rationale
- **Standardization:**
  Renaming columns to more descriptive names improves data clarity and consistency, making it easier for analysts to work with the dataset.
- **Unique Identification:**
  The creation of the `unique_store_id` is critical to ensure that each store is uniquely identified across the dataset, which is essential for accurate data integration and analysis.
- **Foundation for Downstream Processing:**
  These transformations prepare the raw data for further analytical modeling and reporting, ensuring that subsequent stages have clean, standardized data.

## Dependencies & Testing Considerations
- **Source Dependency:**
  This model depends on the raw data provided in the `raw_metro_stores` table of the `pos` schema. Any changes in the source schema should be reflected in this model.
- **Testing Recommendations:**
  - **Not Null Tests:** Ensure that key fields such as `store_name`, `store_id`, `banner`, `province`, and `unique_store_id` are not null.
  - **Uniqueness Test:** Verify that the `unique_store_id` is unique across all records.
  - **Transformation Accuracy:** Validate that the renaming and concatenation operations are performed correctly.

## Conclusion
The `stg_metro_stores` model effectively cleans and standardizes raw store data by applying necessary column renaming and generating a unique identifier. This transformation is crucial for ensuring data integrity and consistency, thereby providing a solid foundation for downstream analytics and reporting.
