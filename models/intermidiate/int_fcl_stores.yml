version: 2

models:
  - name: int_fcl_stores
    description: >
      This model enriches Federated Coop (FCL) store data by integrating discount banner information
      to classify each store into a sales channel. It sources data from the staging model `stg_fcl_stores`
      and the raw discount banners table to derive a new `channel` field. Stores with banners that match
      any discount banner are classified as 'Discount'; all others are classified as 'Conventional'.
    config:
      tags: ['dStores'] # Using the tag to differenciate the fact from the dimension tables
    meta:  # Additional metadata
      owner: Bruno Silva  # Model owner
      type: view  # Model type (table or view)
      data_source: POS Federated Coop   # Model package
      language: sql  # Language used to define the model
      relation: bigquery.stg.fcl_store
    columns:
      - name: store_name
        description: "The name of the store as provided in the FCL staging data."
        tests:
          - not_null
      - name: store_id
        description: "Unique identifier for each store."
        tests:
          - not_null
      - name: banner
        description: "Store banner or brand information."
        tests:
          - not_null
      - name: province
        description: "The province where the store is located."
        tests:
          - not_null
      - name: retail_group
        description: "The retail group affiliation of the store."
        tests:
          - not_null
      - name: unique_store_id
        description: >
          A composite unique identifier generated by concatenating `retail_group` and `store_id`
          with a pipe (`|`) separator.
        tests:
          - not_null
          - unique
      - name: channel
        description: >
          Sales channel classification derived from the store's banner.
          If the banner is found in the discount banners list, the store is classified as 'Discount',
          otherwise it is classified as 'Conventional'.
        tests:
          - not_null
          - accepted_values:
              values: ['Discount', 'Conventional']
